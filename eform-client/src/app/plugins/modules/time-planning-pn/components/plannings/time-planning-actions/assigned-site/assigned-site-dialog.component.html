<div mat-dialog-title>{{ data.siteName }}</div>
<div mat-dialog-content>
  <mat-tab-group
    dynamicHeight="false"
  >
    <mat-tab label="{{'General' | translate }}">
      <div class="d-flex flex-row" *ngIf="selectCurrentUserIsAdmin$ | async">
        <!-- data.useGoogleSheetAsDefault -->
        <mat-checkbox class="p-1"
                      [id]="'useGoogleSheetAsDefault'"
                      [name]="'useGoogleSheetAsDefault'"
                      [(ngModel)]="data.useGoogleSheetAsDefault">
          {{ 'Use Google Sheet as default' | translate }}
        </mat-checkbox>
      </div>
      <div class="d-flex flex-row" *ngIf="!data.useGoogleSheetAsDefault && selectCurrentUserIsAdmin$ | async" >
        <!-- data.useOnlyPlanHours checkbox -->
        <mat-checkbox class="p-1"
                      [id]="'useOnlyPlanHours'"
                      [name]="'useOnlyPlanHours'"
                      [(ngModel)]="data.useOnlyPlanHours">
          {{ 'Use only plan hours' | translate }}
        </mat-checkbox>
      </div>
<!--      <div class="d-flex flex-row">-->
<!--         data.useOneMinuteIntervals -->
<!--        <mat-checkbox class="p-1"-->
<!--                      [id]="'useOneMinuteIntervals'"-->
<!--                      [name]="'useOneMinuteIntervals'"-->
<!--                      [(ngModel)]="data.useOneMinuteIntervals">-->
<!--          {{ 'Use one minute intervals' | translate }}-->
<!--        </mat-checkbox>-->
<!--      </div>-->
<!--      <div class="d-flex flex-row">-->
<!--        &lt;!&ndash; data.useDetailedPauseEditing &ndash;&gt;-->
<!--        <mat-checkbox class="p-1"-->
<!--                      [id]="'useDetailedPauseEditing'"-->
<!--                      [name]="'useDetailedPauseEditing'"-->
<!--                      [(ngModel)]="data.useDetailedPauseEditing">-->
<!--          {{ 'Use detailed pause editing' | translate }}-->
<!--        </mat-checkbox>-->
<!--      </div>-->
      <div class="d-flex flex-row" *ngIf="data.globalAutoBreakCalculationActive && selectCurrentUserIsAdmin$ | async">
        <!-- data.autoBreakCalculationActive -->
        <mat-checkbox class="p-1"
                      [id]="'autoBreakCalculationActive'"
                      [name]="'autoBreakCalculationActive'"
                      [(ngModel)]="data.autoBreakCalculationActive">
          {{ 'Auto break calculation' | translate }}
        </mat-checkbox>
      </div>
      <div class="d-flex flex-row">
        <!-- data.allowEditOfRegistrations -->
        <mat-checkbox class="p-1"
                      [id]="'allowEditOfRegistrations'"
                      [name]="'allowEditOfRegistrations'"
                      [(ngModel)]="data.allowEditOfRegistrations">
          {{ 'Allow edit of registrations' | translate }}
        </mat-checkbox>
      </div>
      <div class="d-flex flex-row">
        <!-- data.allowPersonalTimeRegistration -->
        <mat-checkbox class="p-1"
                      [id]="'allowPersonalTimeRegistration'"
                      [name]="'allowPersonalTimeRegistration'"
                      [(ngModel)]="data.allowPersonalTimeRegistration">
          {{ 'Allow personal time registration' | translate }}
        </mat-checkbox>
      </div>
      <div class="d-flex flex-row" *ngIf="data.allowPersonalTimeRegistration && !data.allowAcceptOfPlannedHours">
        <!-- data.allowPersonalTimeRegistration -->
        <mat-checkbox class="p-1"
                      [id]="'usePunchClock'"
                      [name]="'usePunchClock'"
                      [(ngModel)]="data.usePunchClock">
          {{ 'Use punch clock' | translate }}
        </mat-checkbox>
      </div>
      <div class="d-flex flex-row" *ngIf="data.allowPersonalTimeRegistration && !data.usePunchClock && selectCurrentUserIsAdmin$ | async">
        <!-- data.allowAcceptOfPlannedHours -->
        <mat-checkbox class="p-1"
                      [id]="'allowAcceptOfPlannedHours'"
                      [name]="'allowAcceptOfPlannedHours'"
                      [(ngModel)]="data.allowAcceptOfPlannedHours">
          {{ 'Allow accept of planned hours' | translate }}
        </mat-checkbox>
      </div>
    </mat-tab>
    <mat-tab label="{{'Plan hours' | translate }}" *ngIf="data.useOnlyPlanHours && !data.useGoogleSheetAsDefault && selectCurrentUserIsAdmin$ | async">
      <div class="d-flex flex-row"
           *ngFor="let day of ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']">
        <mat-form-field class="p-1">
          <mat-label>{{ day | translate }}</mat-label>
          <input matInput type="text" readonly disabled>
        </mat-form-field>
        <mat-form-field class="p-1">
          <mat-label>{{ 'Plan hours' | translate }}</mat-label>
          <input
            type="number"
            matInput
            [id]="day.toLowerCase() + 'PlanHours'"
            [name]="day.toLowerCase() + 'PlanHours'"
            [(ngModel)]="data[day.toLowerCase() + 'PlanHours']"
          >
        </mat-form-field>
      </div>
    </mat-tab>
    <mat-tab label="{{ 'Auto break calculation settings' | translate }}" *ngIf="data.autoBreakCalculationActive && selectCurrentUserIsAdmin$ | async">
      <ng-container *ngFor="let day of ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']">
        <div class="d-flex flex-row">
          <mat-form-field class="p-1">
            <mat-label>{{ day + ' break time divider in minutes' | translate }}</mat-label>
            <input
              matInput
              [ngxTimepicker]="timePicker"
              [format]="24"
              placeholder="HH:MM"
              [id]="day.toLowerCase() + 'BreakMinutesDivider'"
              [name]="day.toLowerCase() + 'BreakMinutesDivider'"
              [ngModel]="getConvertedValue(data[day.toLowerCase() + 'BreakMinutesDivider'])"
              [disabled]="!data.autoBreakCalculationActive"
              readonly
            >
            <ngx-material-timepicker
                #timePicker
                [format]="24"
                (timeSet)="setMinutes($event, day.toLowerCase() + 'BreakMinutesDivider')"
            ></ngx-material-timepicker>
          </mat-form-field>
          <mat-form-field class="p-1">
            <mat-label>{{ day + ' break time pr divider in minutes' | translate }}</mat-label>
            <input
              matInput
              [ngxTimepicker]="timePickerPrDivider"
              [format]="24"
              placeholder="HH:MM"
              [id]="day.toLowerCase() + 'BreakMinutesPrDivider'"
              [name]="day.toLowerCase() + 'BreakMinutesPrDivider'"
              [ngModel]="getConvertedValue(data[day.toLowerCase() + 'BreakMinutesPrDivider'])"
              [disabled]="!data.autoBreakCalculationActive"
              readonly>
            <ngx-material-timepicker
                #timePickerPrDivider
                [format]="24"
                (timeSet)="setMinutes($event, day.toLowerCase() + 'BreakMinutesPrDivider')"
            ></ngx-material-timepicker>
          </mat-form-field>
          <mat-form-field class="p-1">
            <mat-label>{{ day + ' break upper limit' | translate }}</mat-label>
            <input
              matInput
              [ngxTimepicker]="timePickerUpperLimit"
              [format]="24"
              placeholder="HH:MM"
              [id]="day.toLowerCase() + 'BreakMinutesUpperLimit'"
              [name]="day.toLowerCase() + 'BreakMinutesUpperLimit'"
              [ngModel]="getConvertedValue(data[day.toLowerCase() + 'BreakMinutesUpperLimit'])"
              [disabled]="!data.autoBreakCalculationActive"
              readonly
            >
          </mat-form-field>
          <ngx-material-timepicker
              #timePickerUpperLimit
              [format]="24"
              (timeSet)="setMinutes($event, day.toLowerCase() + 'BreakMinutesUpperLimit')"
          ></ngx-material-timepicker>
          <div class="pt-4">
            <button
              mat-icon-button
              (click)="copyBreakSettings(day.toLowerCase())"
              color="warn">
              <mat-icon>sync_arrow_down</mat-icon>
            </button>
          </div>
        </div>
      </ng-container>
    </mat-tab>
    <mat-tab label="{{'1st shift' | translate }}" *ngIf="!data.useOnlyPlanHours && !data.useGoogleSheetAsDefault && selectCurrentUserIsAdmin$ | async">
      <ng-container *ngIf="selectCurrentUserIsAdmin$ | async">
        <div class="d-flex flex-row"
             *ngFor="let day of ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']">
          <mat-form-field class="p-1">
            <mat-label>{{ day | translate }}</mat-label>
            <input matInput type="text" readonly disabled>
          </mat-form-field>
          <mat-form-field class="p-1">
            <mat-label>{{ 'Start at' | translate }}</mat-label>
            <input
              type="text"
              matInput
              mask="00:00"
              placeholder="HH:MM"
              [id]="'start' + day"
              [name]="'start' + day"
              [ngModel]="getConvertedValue(data['start' + day], data['end' + day])"
              (change)="setMinutes($event, 'start' + day)">
          </mat-form-field>
          <mat-form-field class="p-1">
            <mat-label>{{ 'End at' | translate }}</mat-label>
            <input
              type="text"
              matInput
              mask="00:00"
              placeholder="HH:MM"
              [id]="'end' + day"
              [name]="'end' + day"
              [ngModel]="getConvertedValue(data['end' + day])"
              (change)="setMinutes($event, 'end' + day)">
          </mat-form-field>
          <mat-form-field class="p-1" *ngIf="!data.autoBreakCalculationActive">
            <mat-label>{{ 'Break time' | translate }}</mat-label>
            <input
              type="text"
              matInput
              mask="00:00"
              placeholder="HH:MM"
              [id]="'break' + day"
              [name]="'break' + day"
              [ngModel]="getConvertedValue(data['break' + day])"
              (change)="setMinutes($event, 'break' + day)">
          </mat-form-field>
          <mat-form-field class="p-1">
            <mat-label>{{ 'Calculated hours' | translate }}</mat-label>
            <input
              type="text"
              matInput
              [id]="day.toLowerCase() + 'CalculatedHours'"
              [name]="day.toLowerCase() + 'CalculatedHours'"
              [(ngModel)]="data[day.toLowerCase() + 'CalculatedHours']"
              readonly disabled>
          </mat-form-field>
        </div>
      </ng-container>
    </mat-tab>
    <mat-tab label="{{'2nd shift' | translate }}" *ngIf="!data.useOnlyPlanHours && !data.useGoogleSheetAsDefault && selectCurrentUserIsAdmin$ | async">
      <ng-container *ngIf="selectCurrentUserIsAdmin$ | async">
        <div class="d-flex flex-row"
             *ngFor="let day of ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']">
          <mat-form-field class="p-1">
            <mat-label>{{ day | translate }}</mat-label>
            <input matInput type="text" readonly disabled>
          </mat-form-field>
          <mat-form-field class="p-1">
            <mat-label>{{ 'Start at' | translate }}</mat-label>
            <input
              type="text"
              matInput
              mask="00:00"
              placeholder="HH:MM"
              [id]="'start' + day + '2NdShift'"
              [name]="'start' + day + '2NdShift'"
              [ngModel]="getConvertedValue(data['start' + day + '2NdShift'], data['end' + day + '2NdShift'])"
              (change)="setMinutes($event, 'start' + day + '2NdShift')">
          </mat-form-field>
          <mat-form-field class="p-1">
            <mat-label>{{ 'End at' | translate }}</mat-label>
            <input
              type="text"
              matInput
              mask="00:00"
              placeholder="HH:MM"
              [id]="'end' + day + '2NdShift'"
              [name]="'end' + day + '2NdShift'"
              [ngModel]="getConvertedValue(data['end' + day + '2NdShift'])"
              (change)="setMinutes($event, 'end' + day + '2NdShift')">
          </mat-form-field>
          <mat-form-field class="p-1" *ngIf="!data.autoBreakCalculationActive">
            <mat-label>{{ 'Break time' | translate }}</mat-label>
            <input
              type="text"
              matInput
              mask="00:00"
              placeholder="HH:MM"
              [id]="'break' + day + '2NdShift'"
              [name]="'break' + day + '2NdShift'"
              [ngModel]="getConvertedValue(data['break' + day + '2NdShift'])"
              (change)="setMinutes($event, 'break' + day + '2NdShift')">
          </mat-form-field>
          <mat-form-field class="p-1">
            <mat-label>{{ 'Calculated hours' | translate }}</mat-label>
            <input
              type="text"
              matInput
              [id]="day.toLowerCase() + 'CalculatedHours'"
              [name]="day.toLowerCase() + 'CalculatedHours'"
              [(ngModel)]="data[day.toLowerCase() + 'CalculatedHours']"
              readonly disabled>
          </mat-form-field>
        </div>
      </ng-container>
    </mat-tab>
  </mat-tab-group>
</div>
<div mat-dialog-actions class="d-flex flex-row justify-content-end">
  <button mat-raised-button mat-dialog-close
  id="cancelButton">
    {{ 'Cancel' | translate }}
  </button>
  <button
    mat-raised-button
    color="accent"
    id="saveButton"
    (click)="updateAssignedSite()"
    [mat-dialog-close]="data">
    {{ 'Save' | translate }}
  </button>
</div>
